import{j as A,k as V,r as c,v as j,o as n,l as d,a as l,b as i,w as s,e as p,t as f,m as _,F as w,x as b,c as x,y as I,T as L,B as W,s as $}from"./index-Bby_nErz.js";import{a as k}from"./axios-CCb-kr4I.js";import{N as z}from"./text-BM-U9Ls2.js";const S={class:"flex flex-wrap gap-4 p-4"},D={key:0,class:"mt-4 p-4 bg-green-500 text-white rounded-lg"},H={key:1,class:"mt-4 p-4 bg-red-500 text-white rounded-lg"},R={class:"card-container mt-4 w-80"},Y={class:"flex items-center"},q={class:"font-semibold ml-2"},G={class:"flex justify-end mt-2"},J={class:"category-container flex flex-wrap gap-4 mt-4"},K={__name:"index",setup(O){const E=V(),F=c(["SIEM"]),v=c([]),r=c(""),o=c(""),u=c([]);c(!1);const T=[{name:"Compliance",url:"/compliance"},{name:"File Integrity Monitoring",url:"/fileIntegrity"},{name:"Mitre Attack",url:"/mitreAttack"},{name:"Windows Event Logs",url:"/windowsEvent"},{name:"Summary",url:"/summary"}],B=t=>{u.value.includes(t)?u.value=u.value.filter(e=>e!==t):u.value.push(t)},M=t=>{E.push(t)},y=async()=>{try{const t=await k.get("/api/v1/plugins/");v.value=t.data.filter(e=>e.activated).map(e=>e.name)}catch(t){console.error("Error fetching activated plugins:",t),o.value="Failed to fetch plugins."}},N=async t=>{try{const e=await k.post("/api/v1/plugins/activate/",{plugin:t},{headers:{"Content-Type":"application/json"}});r.value=e.data.message,y()}catch(e){console.error("Error activating plugin:",e),o.value="Failed to activate plugin."}setTimeout(()=>{r.value="",o.value=""},3e3)},P=async t=>{try{const e=await k.delete("/api/v1/plugins/delete_by_name/",{data:{plugin:t},headers:{"Content-Type":"application/json"}});r.value=e.data.message,y()}catch(e){console.error("Error deactivating plugin:",e),o.value="Failed to deactivate plugin."}setTimeout(()=>{r.value="",o.value=""},3e3)};return j(()=>{y()}),(t,e)=>{const h=z,C=W,m=$;return n(),d(w,null,[l("div",S,[i(m,{class:"p-4 w-full md:w-4/4 shadow-md rounded-lg"},{default:s(()=>[i(h,{class:"text-lg font-bold"},{default:s(()=>e[0]||(e[0]=[p("Plugins")])),_:1}),r.value?(n(),d("div",D,f(r.value),1)):_("",!0),o.value?(n(),d("div",H,f(o.value),1)):_("",!0),l("div",R,[(n(!0),d(w,null,b(F.value,a=>(n(),x(m,{key:a,class:I(["hover-card",{"selected-card":u.value.includes(a),"activated-card":v.value.includes(a)}]),onClick:g=>B(a)},{default:s(()=>[l("div",Y,[e[1]||(e[1]=l("img",{src:"https://upload.wikimedia.org/wikipedia/commons/6/6c/Wazuh_blue.png",class:"sFlh5c FyHeAf iPVvYb",style:{"max-width":"225px",height:"30px",margin:"0px",width:"30px"},alt:"File:Wazuh blue.png - Wikimedia Commons"},null,-1)),l("div",q,f(a),1)]),l("div",G,[v.value.includes(a)?_("",!0):(n(),x(C,{key:0,type:"success",onClick:g=>N(a)},{default:s(()=>e[2]||(e[2]=[p(" Activate ")])),_:2},1032,["onClick"])),v.value.includes(a)?(n(),x(C,{key:1,type:"error",onClick:g=>P(a)},{default:s(()=>e[3]||(e[3]=[p(" Deactivate ")])),_:2},1032,["onClick"])):_("",!0)])]),_:2},1032,["class","onClick"]))),128))])]),_:1})]),i(L,{name:"category-transition",onBeforeEnter:t.beforeEnter,onEnter:t.enter,onLeave:t.leave},{default:s(()=>[i(m,{class:"p-4 w-full shadow-md rounded-lg mt-10"},{default:s(()=>[i(h,{class:"text-lg font-bold"},{default:s(()=>e[4]||(e[4]=[p("Categories")])),_:1}),l("div",J,[(n(),d(w,null,b(T,(a,g)=>i(m,{key:g,class:"category-card hover-card p-4 shadow-md rounded-lg w-125",hoverable:"",onClick:Q=>M(a.url)},{default:s(()=>[i(h,{class:"text-md font-semibold"},{default:s(()=>[p(f(a.name),1)]),_:2},1024)]),_:2},1032,["onClick"])),64))])]),_:1})]),_:1},8,["onBeforeEnter","onEnter","onLeave"])],64)}}},ee=A(K,[["__scopeId","data-v-770b2fc2"]]);export{ee as default};
