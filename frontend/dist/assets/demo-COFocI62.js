import{d as $,hM as B,r as _,s as S,m as V,o as z,c as A,w as t,e,f as u,t as p,q as y,hN as D,J as I,l as M,I as F,B as R,_ as L}from"./index-BdUTWwbS.js";import{_ as T,a as j}from"./DescriptionsItem-B6WIsNe6.js";import{_ as q,a as G}from"./FormItem-HvJ2BmDO.js";const H=$({__name:"demo",setup(J){const f=B(),{userInfo:b}=f,g=_(),h=_(!1),d=S(),l=_({id:"",username:"",nickname:"",email:"",role:"",avatar:""}),o=_({name:"",Nickname:"",email:"",password:""});async function w(){try{const n=await y.get(`/api/v1/user-profile/${b?.id}/`,{headers:{Authorization:`Bearer ${f.token}`}});if(n.status===200){const a=n.data;l.value=a,o.value={name:a.username,Nickname:a.nickname,email:a.email,password:""}}}catch(n){console.error("Error fetching user profile:",n),d.error("Failed to fetch user profile")}}async function N(n){const a=new FormData;a.append("avatar",n);try{const r=await y.post(`/api/v1/user-profile/${l.value.id}/upload-avatar/`,a,{headers:{Authorization:`Bearer ${f.token}`,"Content-Type":"multipart/form-data"}});r.status===200&&(l.value.avatar=r.data.avatar,d.success("Profile picture updated successfully"))}catch(r){console.error("Error updating profile picture:",r),d.error("Failed to update profile picture")}}function E(){const n=document.createElement("input");n.type="file",n.accept="image/*",n.addEventListener("change",a=>{const r=a.target.files?.[0];r&&N(r)}),n.click()}function U(){g.value?.validate(n=>{n?d.error("Validation failed"):updateUserProfile()})}return V(w),(n,a)=>{const r=D,i=T,C=j,v=I,k=M,m=F,c=q,P=R,x=G;return z(),A(v,{vertical:""},{default:t(()=>[e(k,{title:"User Management"},{default:t(()=>[e(v,{size:"large",align:"center"},{default:t(()=>[e(r,{round:"",size:128,src:l.value?.avatar||"",onClick:E,class:"avatar-clickable"},null,8,["src"]),e(C,{"label-placement":"left",column:2,title:`Hello, ${l.value?.nickname||"Guest"}`},{default:t(()=>[e(i,{label:"ID"},{default:t(()=>[u(p(l.value?.id),1)]),_:1}),e(i,{label:"Username"},{default:t(()=>[u(p(l.value?.username),1)]),_:1}),e(i,{label:"Nickname"},{default:t(()=>[u(p(l.value?.nickname),1)]),_:1}),e(i,{label:"Email"},{default:t(()=>[u(p(l.value?.email),1)]),_:1}),e(i,{label:"Role"},{default:t(()=>[u(p(l.value?.role),1)]),_:1})]),_:1},8,["title"])]),_:1})]),_:1}),e(k,{title:"Edit User Profile"},{default:t(()=>[e(v,{justify:"center"},{default:t(()=>[e(x,{ref_key:"formRef",ref:g,class:"w-500px","label-width":100,model:o.value},{default:t(()=>[e(c,{label:"Name"},{default:t(()=>[e(m,{value:o.value.name,"onUpdate:value":a[0]||(a[0]=s=>o.value.name=s),placeholder:"Enter username"},null,8,["value"])]),_:1}),e(c,{label:"Nick Name"},{default:t(()=>[e(m,{value:o.value.Nickname,"onUpdate:value":a[1]||(a[1]=s=>o.value.Nickname=s),placeholder:"Enter your nickname"},null,8,["value"])]),_:1}),e(c,{label:"Email"},{default:t(()=>[e(m,{value:o.value.email,"onUpdate:value":a[2]||(a[2]=s=>o.value.email=s),type:"email",placeholder:"Enter email"},null,8,["value"])]),_:1}),e(c,{label:"Password"},{default:t(()=>[e(m,{value:o.value.password,"onUpdate:value":a[3]||(a[3]=s=>o.value.password=s),type:"password",placeholder:"Enter password"},null,8,["value"])]),_:1}),e(c,null,{default:t(()=>[e(P,{type:"primary",loading:h.value,block:"",onClick:U},{default:t(()=>a[4]||(a[4]=[u(" Save Changes ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})}}}),W=L(H,[["__scopeId","data-v-79c93c2d"]]);export{W as default};
