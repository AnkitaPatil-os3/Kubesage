import{a as b}from"./axios-CCb-kr4I.js";import{d as $,aM as B,r as _,z,v as M,o as S,c as V,w as t,b as e,e as u,t as p,hQ as A,M as D,s as F,L as I,B as L,j as R}from"./index-Bby_nErz.js";import{_ as j,a as T}from"./DescriptionsItem-Bxz1uzaj.js";import{_ as G,a as H}from"./FormItem-KNfBvfja.js";const Q=$({__name:"demo",setup(q){const f=B(),{userInfo:y}=f,g=_(),w=_(!1),d=z(),l=_({id:"",username:"",nickname:"",email:"",role:"",avatar:""}),o=_({name:"",Nickname:"",email:"",password:""});async function h(){try{const n=await b.get(`/api/v1/user-profile/${y?.id}/`,{headers:{Authorization:`Bearer ${f.token}`}});if(n.status===200){const a=n.data;l.value=a,o.value={name:a.username,Nickname:a.nickname,email:a.email,password:""}}}catch(n){console.error("Error fetching user profile:",n),d.error("Failed to fetch user profile")}}async function E(n){const a=new FormData;a.append("avatar",n);try{const r=await b.post(`/api/v1/user-profile/${l.value.id}/upload-avatar/`,a,{headers:{Authorization:`Bearer ${f.token}`,"Content-Type":"multipart/form-data"}});r.status===200&&(l.value.avatar=r.data.avatar,d.success("Profile picture updated successfully"))}catch(r){console.error("Error updating profile picture:",r),d.error("Failed to update profile picture")}}function N(){const n=document.createElement("input");n.type="file",n.accept="image/*",n.addEventListener("change",a=>{const r=a.target.files?.[0];r&&E(r)}),n.click()}function U(){g.value?.validate(n=>{n?d.error("Validation failed"):updateUserProfile()})}return M(h),(n,a)=>{const r=A,i=j,C=T,v=D,k=F,m=I,c=G,P=L,x=H;return S(),V(v,{vertical:""},{default:t(()=>[e(k,{title:"User Management"},{default:t(()=>[e(v,{size:"large",align:"center"},{default:t(()=>[e(r,{round:"",size:128,src:l.value?.avatar||"",onClick:N,class:"avatar-clickable"},null,8,["src"]),e(C,{"label-placement":"left",column:2,title:`Hello, ${l.value?.nickname||"Guest"}`},{default:t(()=>[e(i,{label:"ID"},{default:t(()=>[u(p(l.value?.id),1)]),_:1}),e(i,{label:"Username"},{default:t(()=>[u(p(l.value?.username),1)]),_:1}),e(i,{label:"Nickname"},{default:t(()=>[u(p(l.value?.nickname),1)]),_:1}),e(i,{label:"Email"},{default:t(()=>[u(p(l.value?.email),1)]),_:1}),e(i,{label:"Role"},{default:t(()=>[u(p(l.value?.role),1)]),_:1})]),_:1},8,["title"])]),_:1})]),_:1}),e(k,{title:"Edit User Profile"},{default:t(()=>[e(v,{justify:"center"},{default:t(()=>[e(x,{ref_key:"formRef",ref:g,class:"w-500px","label-width":100,model:o.value},{default:t(()=>[e(c,{label:"Name"},{default:t(()=>[e(m,{value:o.value.name,"onUpdate:value":a[0]||(a[0]=s=>o.value.name=s),placeholder:"Enter username"},null,8,["value"])]),_:1}),e(c,{label:"Nick Name"},{default:t(()=>[e(m,{value:o.value.Nickname,"onUpdate:value":a[1]||(a[1]=s=>o.value.Nickname=s),placeholder:"Enter your nickname"},null,8,["value"])]),_:1}),e(c,{label:"Email"},{default:t(()=>[e(m,{value:o.value.email,"onUpdate:value":a[2]||(a[2]=s=>o.value.email=s),type:"email",placeholder:"Enter email"},null,8,["value"])]),_:1}),e(c,{label:"Password"},{default:t(()=>[e(m,{value:o.value.password,"onUpdate:value":a[3]||(a[3]=s=>o.value.password=s),type:"password",placeholder:"Enter password"},null,8,["value"])]),_:1}),e(c,null,{default:t(()=>[e(P,{type:"primary",loading:w.value,block:"",onClick:U},{default:t(()=>a[4]||(a[4]=[u(" Save Changes ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})}}}),X=R(Q,[["__scopeId","data-v-79c93c2d"]]);export{X as default};
