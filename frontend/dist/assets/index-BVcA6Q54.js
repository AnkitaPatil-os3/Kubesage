import{j as k,k as M,z as L,r as b,o,l as n,b as c,w as i,e as v,a as s,F as g,x as _,y as B,t as f,m as Q,A as C,s as A}from"./index-Bby_nErz.js";import{a as V}from"./axios-CCb-kr4I.js";import{N as I}from"./text-BM-U9Ls2.js";const P={class:"flex flex-wrap gap-4 p-4"},z={class:"flex flex-col gap-6 w-full mt-4"},F={class:"flex flex-wrap gap-4"},N={class:"d-flex"},O=["src"],$={class:"font-semibold"},E={class:"mt-4"},T={class:"w-full table-auto border-collapse"},j={key:0},R={class:"border p-2"},U={class:"border p-2 text-center"},G=["onClick"],H={__name:"index",setup(J){const x=M(),h=L(),d=b(""),u=b([]),y={PostgreSQL:"/databases/postgres",MySQL:"/databases/mysql","Microsoft SQL Server":"/databases/mssql","Oracle DB":"/databases/oracledb",MongoDB:"/databases/mongodb"},w=(a,e)=>{const t=y[a];if(!t){h.warning("No dashboard available for this database.");return}x.push({path:t,query:{instance:e}})},D={Databases:[{name:"PostgreSQL",icon:"https://img.icons8.com/color/48/postgreesql.png"},{name:"MySQL",icon:"https://img.icons8.com/fluency/48/mysql-logo.png"},{name:"Microsoft SQL Server",icon:"https://img.icons8.com/color/48/microsoft-sql-server.png"},{name:"Oracle DB",icon:"https://img.icons8.com/color/48/oracle-logo.png"},{name:"MongoDB",icon:"https://img.icons8.com/color/48/mongodb.png"}]},q=async a=>{d.value=a,u.value=[];let e=[];try{if(a==="PostgreSQL"){const t=await V.get("https://10.0.34.212:9090/api/v1/query?query=count(pg_up)by(instance)");t.data.status==="success"&&t.data.data.result.length>0&&(e=t.data.data.result.map(r=>({instance:`postgresql://${r.metric.instance}`})))}else a==="MySQL"?e=[{instance:"mysql://10.0.34.221:3306/"},{instance:"mysql://10.0.34.223:3306/"}]:a==="Microsoft SQL Server"?e=[{instance:"mssql://10.0.34.224:1433/"},{instance:"mssql://10.0.34.225:1433/"}]:a==="Oracle DB"?e=[{instance:"oracle://10.0.34.226:1521/"},{instance:"oracle://10.0.34.227:1521/"}]:a==="MongoDB"&&(e=[{instance:"mongodb://10.0.34.228:27017/"},{instance:"mongodb://10.0.34.229:27017/"}]);u.value=e}catch(t){console.error("Error fetching agent details:",t),h.error("Failed to fetch agent details")}};return(a,e)=>{const t=I,r=A;return o(),n("div",P,[c(r,{class:"p-4 w-full md:w-4/4 shadow-md rounded-lg"},{default:i(()=>[c(t,{class:"text-lg font-bold"},{default:i(()=>e[0]||(e[0]=[v("Databases Dashboards ")])),_:1}),s("div",z,[(o(),n(g,null,_(D,(m,p)=>s("div",{key:p},[s("div",F,[(o(!0),n(g,null,_(m,(l,S)=>(o(),n("div",{key:S},[c(r,{class:B(["hover-card w-70",{"selected-card":d.value===l.name}]),onClick:K=>q(l.name)},{default:i(()=>[s("div",N,[s("img",{src:l.icon,alt:"Agent Icon",class:"mr-2",style:{width:"40px",height:"40px"}},null,8,O),s("span",$,f(l.name),1)])]),_:2},1032,["class","onClick"])]))),128))])])),64))])]),_:1}),c(r,{class:"p-4 w-full md:w-4/4 shadow-md rounded-lg mt-6"},{default:i(()=>[c(t,{class:"text-lg font-bold"},{default:i(()=>[v("Database Instances - "+f(d.value),1)]),_:1}),s("div",E,[s("table",T,[e[2]||(e[2]=s("thead",null,[s("tr",null,[s("th",{class:"border p-2 bg-gray-200"},"Instance"),s("th",{class:"border p-2 bg-gray-200"},"Dashboard")])],-1)),s("tbody",null,[u.value.length===0?(o(),n("tr",j,e[1]||(e[1]=[s("td",{class:"border p-2 text-center",colspan:"2"},"No agent onboard yet",-1)]))):Q("",!0),(o(!0),n(g,null,_(u.value,(m,p)=>(o(),n("tr",{key:p},[s("td",R,f(m.instance),1),s("td",U,[s("a",{href:"#",onClick:C(l=>w(d.value,m.instance),["prevent"]),class:"text-blue-600 hover:underline cursor-pointer"}," View Dashboard ",8,G)])]))),128))])])])]),_:1})])}}},Z=k(H,[["__scopeId","data-v-9ace19f3"]]);export{Z as default};
